<?xml version="1.0"?>
<project  name="Seam2 Build Utilities" basedir="." default="help" xmlns:artifact="urn:maven-artifact-ant">

	<path id="maven-ant-tasks.classpath" path="lib/maven-ant-tasks.jar" />
	<typedef resource="org/apache/maven/artifact/ant/antlib.xml" uri="urn:maven-artifact-ant" classpathref="maven-ant-tasks.classpath" />

	<property name="seam.dir" value="${basedir}/../" />
	<property name="tmp.dir" value="${seam.dir}/classes" />
	<property name="build.dir" value="${basedir}" />
	<property file="${seam.dir}/build.properties" />

	<import file="utilities.build.xml" />
	<import file="common.build.xml" />

	<target name="deployLocal" description="Deploy a pom and jar to local (development) repository">
		<pomfile name="pom.file" value="${pom}" />
		<deployLocal pom="${pom.file}" jar="${jar}" />
	</target>

	<target name="deployLocalPom" description="Deploy a pom to the (development) repository">
		<deployLocal pom="${pom}" />
	</target>

	<target name="deployLocalJar" description="Deploy a jar (generating the pom) to local (development) repository">
		<deployLocal jar="${jar}" />
	</target>

	<target name="installProfiles" description="Deploy all profiles to the local (development) repository">
		<installProfile pom="profiles/seam-ajax.pom.xml" />
		<installProfile pom="profiles/seam-async-timer-quartz.pom.xml" />
		<installProfile pom="profiles/seam-cache.pom.xml" />
		<installProfile pom="profiles/seam-captcha.pom.xml" />
		<installProfile pom="profiles/seam-ejb3.pom.xml" />
		<installProfile pom="profiles/seam-facelets.pom.xml" />
		<installProfile pom="profiles/seam-gwt.pom.xml" />
		<installProfile pom="profiles/seam-jpa.pom.xml" />
		<installProfile pom="profiles/seam-jpdl.pom.xml" />
		<installProfile pom="profiles/seam-jpdl-tomcat.pom.xml" />
		<installProfile pom="profiles/seam-richfaces.pom.xml" />
		<installProfile pom="profiles/seam-rules.pom.xml" />
		<installProfile pom="profiles/seam-search.pom.xml" />
		<installProfile pom="profiles/seam-spring.pom.xml" />
		<installProfile pom="profiles/seam-urlrewrite.pom.xml" />
	</target>

	<target name="help">
		<echo>Examples:</echo>
		<echo>---------</echo>
		<echo />
		<echo>Deploy both a pom and the associated jar: </echo>
		<echo>   ant deployLocal -Dpom=jboss-el.pom.xml -Djar=jboss-el.jar</echo>
		<echo />
		<echo>Deploy a pom only (useful if packaging is set to pom):</echo>
		<echo>   ant deployLocalPomOnly -Dpom=jboss-el.pom.xml</echo>
		<echo />
		<echo>Deploy a jar and generate a basic pom:</echo>
		<echo>   ant deployLocal -Dpom=jboss-el.pom.xml -Djar=jboss-el.jar</echo>
		<echo />
		<echo>installProfile all profiles to ~/.m2/repository:</echo>
		<echo>   ant installProfileProfiles</echo>
	</target>

	<macrodef name="installProfile">
		<attribute name="pom"/>
		<sequential>
			<pomfile name="pomfile" value="@{pom}" />
			<install pom="${pomfile}" />
		</sequential>
	</macrodef>
	
</project>