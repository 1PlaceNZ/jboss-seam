<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:e="http://jboss.com/products/seam/excel"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
			<title>Microsoft&#174; Excel&#174; Export examples</title>
			<link href="css/screen.css" rel="stylesheet" type="text/css" />
	</head>
	<body id="excelHome">
		<f:view>

			<h:outputText value="Microsoft&#174; Excel&#174; Export examples"
					style="header"></h:outputText>
			<br />
			<br />
	
			<h:outputLink value="jxl.seam">
				<h:outputText>Export as Excel&#174; spreadsheet</h:outputText>
			</h:outputLink>
			<br />

			<h:outputLink value="csv.seam">
				<h:outputText>Export as comma separated file</h:outputText>
			</h:outputLink>
			<br />
			<br />

			<h:form id="excelExport">
				<a4j:commandButton value="Search" reRender="searchResults"
					action="#{excelTest.search}" />
				<a4j:commandButton value="Clear" reRender="searchResults"
					action="#{excelTest.clear}" />

				<a4j:outputPanel id="searchResults">
					<rich:dataTable value="#{excelTest.result}" var="person"
						id="excelTable" columnClasses="left, right">
						<rich:column>
							<f:facet name="header">
								<h:outputText value="First name"/>
							</f:facet>
							<h:outputText value="#{person.name}"/>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Last name"/>
							</f:facet>
							<h:outputText value="#{person.lastName}"/>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Age"/>
							</f:facet>
							<h:outputText value="#{person.age}"/>
						</rich:column>
					</rich:dataTable>
					<h:commandLink value="Export table"
						action="#{excelExporter.export('excelExport:excelTable')}" />
				</a4j:outputPanel>
			</h:form>
		</f:view>
	</body>
</html>

