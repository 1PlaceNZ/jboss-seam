package SeamSpacePermissions;

import org.jboss.seam.security.Identity;
import org.jboss.seam.security.rules.PermissionCheck;
import org.jboss.seam.example.seamspace.MemberImage;

rule ViewImage
when
  c: PermissionCheck(name == "memberImage", action == "view")
  img: MemberImage()
  eval( img.getMember().getPicture() == img )
then
  c.grant();
end;
