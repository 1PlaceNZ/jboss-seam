<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html">

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>seamBay - Search Results</title>
    <link href="style/common.css" rel="stylesheet" type="text/css"/>
    <link href="style/search.css" rel="stylesheet" type="text/css"/>
  </head>

  <body>
    <div class="container">
      <ui:include src="header.xhtml"/>  
      
      <div class="banner"></div>
      
      <h:messages globalOnly="true"/>

      <div id="searchHeader">
        <h:form>
          <h:inputText id="searchTerm" value="#{auctionSearch.searchTerm}" styleClass="searchTerm"/>
          <h:selectOneMenu id="selectedCat" value="#{auctionSearch.searchCategory}">
            <s:selectItems value="#{categories}" var="cat" label="#{cat.name}" noSelectionLabel="All Categories"/>
            <s:convertEntity />
          </h:selectOneMenu>
          
          <h:commandButton action="#{auctionSearch.queryAuctions}" value="Search"/>
        </h:form>
        
      </div>
      
      <div id="searchSidebar">
        <div class="sidebarHeading">
          Matching Categories
        </div>
        
        <ui:repeat value="#{auctionSearch.searchCategories}" var="cat">
          <div><s:link action="#{auctionSearch.selectCategory(cat)}" value="#{cat.key.name}"/> (#{cat.value})</div>
        </ui:repeat>
      </div>

      <div id="searchResults">
      
      	<h:dataTable id="auctions" 
      	             value="#{auctionSearch.results}" 
      	             var="auction" 
      	             cellspacing="0px"
      	             rowClasses="resultRowOdd,resultRowEven"
      	             columnClasses="imageColumn,itemColumn,bidsColumn,priceColumn,timeColumn">
      	  <h:column>
      	    <s:graphicImage rendered="#{auction.image ne null}" value="#{auction.image.data}">
              <s:transformImageSize width="80" maintainRatio="true"/>
      	    </s:graphicImage>
      	  </h:column>
      		<h:column>
      			<f:facet name="header">Item</f:facet>
      			<s:link value="#{auction.title}"/>
      		</h:column>
      		<h:column>
      			<f:facet name="header">Bids</f:facet>
      			#{auction.bids}
      		</h:column>
      		<h:column>
      			<f:facet name="header">Price</f:facet>
      			#{auction.price}
      		</h:column> 
      		<h:column>
      			<f:facet name="header">Time left</f:facet>
      			#{auction.timeLeft}
      		</h:column>
      	</h:dataTable>      
      
      </div>          
    </div>
  </body>
</html>
