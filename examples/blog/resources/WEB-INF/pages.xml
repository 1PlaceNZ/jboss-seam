<?xml version="1.0" encoding="UTF-8"?>
<pages xmlns="http://jboss.com/products/seam/pages"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://jboss.com/products/seam/pages http://jboss.com/products/seam/pages-2.1.xsd"

       login-view-id="/login.xhtml">

   <page view-id="/search.xhtml">
   
      <param name="searchPattern" 
            value="#{searchService.searchPattern}"/>
            
   </page>

   <page view-id="/entry.xhtml"> 
   
      <param name="blogEntryId" 
            value="#{blogEntry.id}"/>
            
      <action execute="#{entryAction.loadBlogEntry(blogEntry.id)}"/>
      
   </page>

   <page view-id="/post.xhtml" login-required="true"> 
         
      <action execute="#{postAction.post}"
                   if="#{validation.succeeded}"/>
                   
      <action execute="#{postAction.invalid}"
                   if="#{validation.failed}"/>
      
      <navigation from-action="#{postAction.post}">
         <redirect view-id="/index.xhtml"/>
      </navigation>
      
   </page>
   
   <page view-id="/login.xhtml">
   
      <action execute="#{identity.login}"
                   if="#{validation.succeeded}"/>
                   
      <navigation>
         <rule if="#{identity.loggedIn}">
            <redirect view-id="/post.xhtml"/>
         </rule>
      </navigation>
      
   </page>

   <page view-id="*">
      <action execute="#{blog.hitCount.hit}"/>
   </page>

</pages>
