<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                template="themes/default/template.xhtml">

<ui:define name="pluginCSS">
    <link href="themes/default/css/languageSelector.css" rel="stylesheet" type="text/css"/>
    <link href="themes/default/css/mainMenu.css" rel="stylesheet" type="text/css"/>
</ui:define>

<ui:define name="screenname">Browse Directory</ui:define>

<ui:define name="headerTopRight">
    <ui:include src="plugins/languageSelector/plugin.xhtml"/>
</ui:define>
<ui:define name="headerBottomLeft">&#160;</ui:define>
<ui:define name="headerBottomRight">&#160;</ui:define>

<ui:define name="sidebar">
    <ui:include src="plugins/mainMenu/plugin.xhtml"/>
</ui:define>

<ui:define name="control">
    <div id="controlDocument">

        <!-- Real directory -->
        <h:panelGroup rendered="#{!empty currentDirectory.parent}">
            <s:link id="createDir"  styleClass="linkNavigation" value="New Subdirectory" action="createDir"/>
            <s:link id="editDir"    styleClass="linkNavigation" value="Edit Directory" action="editDir"/>
            <s:link id="createDoc"  styleClass="linkNavigation" value="New Document" action="createDoc"/>
        </h:panelGroup>

        <!-- Virtual root directory -->
        <h:panelGroup rendered="#{empty currentDirectory.parent}">
            <s:link id="createArea"   styleClass="linkNavigation" value="New Area" action="createDir"/>
            <s:link id="editArea"     styleClass="linkNavigation" value="Edit Areas" action="editDir"/>
        </h:panelGroup>

    </div>
</ui:define>

<ui:define name="content">

    <div class="directoryPathPanel">
        <h:panelGroup>
            <ui:repeat var="directory" value="#{currentDirectoryPath}">
                <s:button view="/dirBrowser.xhtml" value="#{directory.name}" styleClass="directoryButton" propagation="none">
                    <f:param name="dirId" value="#{directory.id}"/>
                </s:button>
                <h:outputText value="/" styleClass="directorySeparator" rendered="#{directory != currentDirectory}"/>
            </ui:repeat>
        </h:panelGroup>
    </div>

    <s:div style="padding: 5px;" rendered="#{empty currentDirectory.children}">
        <h:outputText value="This directory is empty."/>
    </s:div>

    <h:dataTable id="directoryTable" var="node"
                 value="#{currentDirectory.children}"
                 rendered="#{!empty currentDirectory.children}"
                 styleClass="directoryList"
                 columnClasses="iconColumn,nameColumn,permissionsColumn,lastModifiedColumn"
                 rowClasses="rowOdd,rowEven"
                 cellpadding="0" cellspacing="0" border="0">

        <h:column>
            <h:graphicImage value="themes/default/img/icon.dir.gif"
                            width="18" height="20"
                            rendered="#{node.class.simpleName == 'Directory'}"/>
            <h:graphicImage value="themes/default/img/icon.doc.gif"
                            width="18" height="20"
                            rendered="#{node.class.simpleName == 'Document'}"/>
        </h:column>

        <h:column>
            <s:div rendered="#{node.class.simpleName == 'Directory'}">
                <s:link id="browseDirectory" value="#{node.name}" propagation="none">
                    <f:param name="dirId" value="#{node.id}"/>
                </s:link>
            </s:div>
            <s:div rendered="#{node.class.simpleName == 'Document'}">
                <s:link id="displayDoc" value="#{node.name}" view="/docDisplay.xhtml" propagation="none">
                    <f:param name="docId" value="#{node.id}"/>
                </s:link>
            </s:div>
        </h:column>

        <h:column>
            johndoe aGroup rwxrwx---
        </h:column>

        <h:column>
            <h:outputText value="#{node.lastModifiedOn}">
                <f:convertDateTime type="both"/>
            </h:outputText>
        </h:column>

    </h:dataTable>

</ui:define>

<ui:define name="footer">
    Footer
</ui:define>

</ui:composition>

