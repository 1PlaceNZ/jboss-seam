<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:wiki="http://jboss.com/products/seam/wiki"
        xmlns:c="http://java.sun.com/jstl/core"
        xmlns:s="http://jboss.com/products/seam/taglib">

<c:forEach var="childWrapper" items="#{node.wrappedChildren}">
    <s:div styleClass="level#{childWrapper.level}">
        <s:div styleClass="level#{childWrapper.level}Body">
            <h:panelGrid columns="3"
                         columnClasses="level#{childWrapper.level}Marker, level#{childWrapper.level}Icon, level#{childWrapper.level}LinkColumn">

                <h:outputText value="&#183;"/>

                <s:span>
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/icon.dir.gif"
                                    width="18" height="20"
                                    rendered="#{wiki:isDirectory(childWrapper.wrappedNode)}"/>
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/icon.doc.gif"
                                    width="18" height="20"
                                    rendered="#{wiki:isDocument(childWrapper.wrappedNode)}"/>
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/#{uploadTypes[childWrapper.wrappedNode.contentType].displayIcon}"
                                    width="18" height="20"
                                    rendered="#{wiki:isFile(childWrapper.wrappedNode) and !empty uploadTypes[childWrapper.wrappedNode.contentType]}"/>
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/#{uploadTypes['generic'].displayIcon}"
                                    width="18" height="20"
                                    rendered="#{wiki:isFile(childWrapper.wrappedNode) and empty uploadTypes[childWrapper.wrappedNode.contentType]}"/>
                </s:span>

                <h:outputLink styleClass="level#{childWrapper.level}Link" target="_top"
                              value="#{wiki:renderURL(childWrapper.wrappedNode)}">#{wiki:truncateString(childWrapper.wrappedNode.name, 40, '...')}</h:outputLink>

            </h:panelGrid>
        </s:div>
        <s:div styleClass="level#{childWrapper.level}Children" style="padding-left: #{childWrapper.level*7}px;">
            <ui:include src="dirMenuItem.xhtml">
                <ui:param name="node" value="#{childWrapper}"/>
            </ui:include>
        </s:div>
    </s:div>
</c:forEach>

</ui:composition>
