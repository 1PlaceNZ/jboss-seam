<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:wiki="http://jboss.com/products/seam/wiki"
                template="themes/#{globalPrefs.themeName}/template.xhtml">

<ui:define name="pluginCSS">
    <link href="#{themePath}/css/userControl.css" rel="stylesheet" type="text/css"/>
    <link href="#{themePath}/css/searchControl.css" rel="stylesheet" type="text/css"/>
    <link href="#{themePath}/css/mainMenu.css" rel="stylesheet" type="text/css"/>
</ui:define>

<ui:define name="screenname">
    <h:outputText value="Create directory" rendered="#{!directoryHome.managed}"/>
    <h:outputText value="Edit directory" rendered="#{directoryHome.managed}"/>
</ui:define>

<ui:define name="headerTopRight">
    <ui:include src="plugins/userControl/plugin.xhtml"/>
</ui:define>

<ui:define name="headerBottomLeft">&#160;</ui:define>

<ui:define name="headerBottomRight">
    <ui:include src="plugins/searchControl/plugin.xhtml"/>
</ui:define>

<ui:define name="sidebar">
    <ui:include src="plugins/mainMenu/plugin.xhtml"/>
</ui:define>

<ui:define name="controlRight">
    <s:link id="exit" styleClass="linkNavigation"
            action="#{directoryHome.exitConversation(true)}"
            accesskey="E"><u>E</u>xit Editor</s:link>
</ui:define>

<ui:define name="content">

<h:form>
<div class="form">
<div class="formHead">
    <h:outputText value="New directory: #{directoryHome.instance.name}"
                  rendered="#{!directoryHome.managed}"/>
    <h:outputText value="Editing directory: #{directoryHome.instance.name}"
                  rendered="#{directoryHome.managed}"/>
</div>

<div class="formFields">

    <s:validateAll>

        <s:div styleClass="entry" rendered="#{directoryHome.managed and !empty directoryHome.instance.parent}">
            <div class="label">Parent:</div>
            <div class="output">
                <h:outputText value="#{directoryHome.instance.parent.name}"/>
            </div>
        </s:div>

        <s:div styleClass="entry" rendered="#{!directoryHome.managed}">
            <div class="label">Parent:</div>
            <div class="output">
                <h:outputText value="#{directoryHome.parentDirectory.name}"/>
            </div>
        </s:div>

        <s:decorate>
            <div class="entry">
                <div class="label">Name:</div>
                <div class="input">
                    <h:inputText size="40" maxlength="255" id="name" required="true" tabindex="1"
                                 value="#{directoryHome.instance.name}"/>
                </div>
            </div>
        </s:decorate>

    </s:validateAll>

    <s:div styleClass="entry" rendered="#{childNodes.rowCount>0}">
        <div class="label">Content:</div>
        <div class="input">
            <h:dataTable id="directoryFormTable" var="node" width="75%" style="border-width: 1px;"
                         value="#{childNodes}"
                         binding="#{jsfUtil.datatable}"
                         styleClass="directoryList"
                         headerClass="directoryListHeader"
                         columnClasses="positionUpColumn,positionDownColumn,menuControlColumn,defaultDocumentSelectColumn,iconColumn,nameColumn"
                         rowClasses="rowOdd,rowEven"
                         cellpadding="0" cellspacing="0" border="0">

                <h:column>
                    <h:commandLink id="nodeUp" tabindex="1"
                                   action="#{directoryHome.moveNodeUpInList}"
                                   rendered="#{jsfUtil.datatable.rowIndex > 0}">
                        <h:graphicImage value="/themes/#{globalPrefs.themeName}/img/up.gif" width="18" height="18"/>
                    </h:commandLink>
                </h:column>
                <h:column>
                    <h:commandLink id="nodeDown" tabindex="2"
                                   action="#{directoryHome.moveNodeDownInList}"
                                   rendered="#{jsfUtil.datatable.rowIndex+1 lt jsfUtil.datatable.rowCount}">
                        <h:graphicImage value="/themes/#{globalPrefs.themeName}/img/down.gif" width="18" height="18"/>
                    </h:commandLink>
                </h:column>

                <h:column>
                    <f:facet name="header">
                        Menu Item
                    </f:facet>
                    <h:selectBooleanCheckbox value="#{node.menuItem}" tabindex="3"/>
                </h:column>

                <h:column>
                    <f:facet name="header">
                        Start Document
                    </f:facet>
                    <h:commandLink id="defaultDocument" tabindex="4"
                                   action="#{directoryHome.selectDefaultDocument}"
                                   rendered="#{directoryHome.instance.defaultDocument != node and wiki:isDocument(node)}">
                        <h:graphicImage value="/themes/#{globalPrefs.themeName}/img/right.gif" width="18" height="18"/>
                    </h:commandLink>

                    <h:graphicImage value="/themes/#{globalPrefs.themeName}/img/check.gif" width="18" height="18"
                                    rendered="#{directoryHome.instance.defaultDocument == node}"/>

                    <h:outputText value="-" rendered="#{node.class.simpleName == 'Directory'}"/>
                </h:column>

                <h:column>
                    <h:graphicImage value="/themes/#{globalPrefs.themeName}/img/icon.dir.gif"
                                    width="18" height="20"
                                    rendered="#{wiki:isDirectory(node)}"/>
                    <h:graphicImage value="/themes/#{globalPrefs.themeName}/img/icon.doc.gif"
                                    width="18" height="20"
                                    rendered="#{wiki:isDocument(node)}"/>
                </h:column>

                <h:column>
                    <h:outputText value="#{node.name}"/>
                </h:column>

            </h:dataTable>
        </div>
    </s:div>

</div>
<div class="formControls">

    <div class="entry">
        <div class="label">&#160;</div>
        <div class="input">

            <h:commandLink id="preview" styleClass="buttonNonpersistent"
                           action="#{directoryHome.previewMenuItems()}"
                           rendered="#{childNodes.rowCount>0}"
                           tabindex="5" accesskey="P"><span class="buttonLabel"><u>P</u>review</span></h:commandLink>

            <h:commandLink id="save" styleClass="button"
                           action="#{directoryHome.persist}"
                           rendered="#{!directoryHome.managed}"
                           tabindex="6" accesskey="S"><span class="buttonLabel"><u>S</u>ave</span></h:commandLink>

            <h:commandLink id="update" styleClass="button"
                           action="#{directoryHome.update}"
                           rendered="#{directoryHome.managed}"
                           tabindex="7" accesskey="U"><span class="buttonLabel"><u>U</u>pdate</span></h:commandLink>

            <h:commandLink id="delete" styleClass="button"
                           action="#{directoryHome.remove}"
                           rendered="#{directoryHome.managed
                                      and !empty directoryHome.instance.parent
                                      and empty directoryHome.instance.children}"
                           tabindex="8" accesskey="D"><span class="buttonLabel"><u>D</u>elete</span></h:commandLink>

        </div>
    </div>

</div>

</div>
</h:form>

</ui:define>

<ui:define name="footer">&#160;</ui:define>

</ui:composition>

