<ui:decorate template="popupDialog.xhtml"
         xmlns:s="http://jboss.com/products/seam/taglib"
         xmlns:ui="http://java.sun.com/jsf/facelets"
         xmlns:f="http://java.sun.com/jsf/core"
         xmlns:h="http://java.sun.com/jsf/html"
         xmlns:a="https://ajax4jsf.dev.java.net/ajax"
         xmlns:wiki="http://jboss.com/products/seam/wiki"
         xmlns:j4j="http://javascript4jsf.dev.java.net/">

    <ui:param name="dialogId" value="dialogOwnerSelection"/>
    <ui:define name="dialogInit">
        <script type="text/javascript">jQuery(function() {
            jsf('dialogOwnerSelectionPopup')
                .css({ minWidth: "700px", minHeight: "420px", width: "725px;", height: "450px;", top: "100px", left: "100px"})
                .jqm({
                    trigger: jsf("openDialogOwnerSelection"),
                    closeClass: "closeDialog",
                    onShow: fadeInPopupDialog,
                    onHide: fadeOutPopupDialog
                });
        });</script>
    </ui:define>
    <ui:define name="dialogTitle">Select owner...</ui:define>
    <ui:define name="dialogContent">

        <h:form>
        <div class="form" id="userSearchControl" style="margin-bottom: 15px;">
            <h:panelGrid columns="6"
                         styleClass="datatable topLeftBottomBorder"
                         headerClass="regularHeader rightBorder"
                         columnClasses="tenPercentColumn formFields, tenPercentColumn formFields,
                                        tenPercentColumn formFields, tenPercentColumn formFields,
                                        defaultColumn alignRight rightBorder formFields"
                         cellpadding="0" cellspacing="0" border="0">

                <h:panelGroup>
                    <h:outputText styleClass="label" value="Username:"/>&#160;
                    <h:inputText id="username" value="#{userSearch.exampleUser.username}" maxlength="35" size="10" tabindex="20"/>
                </h:panelGroup>

                <h:panelGroup>
                    <h:outputText styleClass="label" value="First name:"/>&#160;
                    <h:inputText id="firstname" value="#{userSearch.exampleUser.firstname}" maxlength="35" size="10" tabindex="20"/>
                </h:panelGroup>

                <h:panelGroup>
                    <h:outputText styleClass="label" value="Last name:"/>&#160;
                    <h:inputText id="lastname" value="#{userSearch.exampleUser.lastname}" maxlength="35" size="10" tabindex="20"/>
                </h:panelGroup>

                <h:panelGroup>
                    <h:outputText styleClass="label" value="E-mail:"/>&#160;
                    <h:inputText id="email" value="#{userSearch.exampleUser.email}" maxlength="35" size="10" tabindex="20"/>
                </h:panelGroup>

                <a:commandLink id="find" styleClass="button" reRender="dialogOwnerSelectionContent"
                               oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')"
                               action="#{userSearch.find()}"
                               tabindex="20" accesskey="F"><span class="buttonLabel"><u>F</u>ind</span></a:commandLink>

            </h:panelGrid>
        </div>

        <s:div id="userPager">
            <h:panelGrid columns="5" styleClass="pager"
                         columnClasses="pagerIconColumn,pagerIconColumn,pagerTextColumn,pagerIconColumn,pagerIconColumn"
                         cellpadding="0" cellspacing="0" border="0"
                         rendered="#{userSearch.rowCount > 0}">

                <a:commandLink action="#{userSearch.firstPage()}" rendered="#{userSearch.previousPageAvailable}" tabindex="20"
                               oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')"
                               reRender="dialogOwnerSelectionContent">
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/page.first.gif" width="13" height="11"/>
                </a:commandLink>
                <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/blank.gif" width="13" height="11"
                                rendered="#{!userSearch.previousPageAvailable}"/>

                <a:commandLink action="#{userSearch.previousPage()}" rendered="#{userSearch.previousPageAvailable}" tabindex="20"
                               oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')"
                               reRender="dialogOwnerSelectionContent">
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/page.previous.gif" width="13" height="11"/>
                </a:commandLink>
                <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/blank.gif" width="13" height="11"
                                rendered="#{!userSearch.previousPageAvailable}"/>

                <h:outputText value="Found: #{userSearch.rowCount} member(s)"/>

                <a:commandLink action="#{userSearch.nextPage()}" rendered="#{userSearch.nextPageAvailable}" tabindex="20"
                               oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')"
                               reRender="dialogOwnerSelectionContent">
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/page.next.gif" width="13" height="11"/>
                </a:commandLink>
                <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/blank.gif" width="13" height="11"
                                rendered="#{!userSearch.nextPageAvailable}"/>

                <a:commandLink action="#{userSearch.lastPage()}" rendered="#{userSearch.nextPageAvailable}" tabindex="20"
                               oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')"
                               reRender="dialogOwnerSelectionContent">
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/page.last.gif" width="13" height="11"/>
                </a:commandLink>
                <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/blank.gif" width="13" height="11"
                                rendered="#{!userSearch.nextPageAvailable}"/>

            </h:panelGrid>
        </s:div>

        <s:div id="userTableContainer" style="margin-bottom: 15px;">
            <h:dataTable id="userTable" var="u"
                         value="#{usersList}"
                         rendered="#{usersList.rowCount >0}"
                         styleClass="datatable topLeftBottomBorder"
                         headerClass="sortableHeader rightBorder"
                         columnClasses="defaultColumn rightBorder alignLeft,
                                        twentyPercentColumn rightBorder alignLeft,
                                        twentyPercentColumn rightBorder alignLeft,
                                        twentyPercentColumn rightBorder alignLeft,
                                        tenPercentColumn rightBorder alignCenter"
                         rowClasses="rowOdd,rowEven"
                         cellpadding="0" cellspacing="0" border="0">

                <h:column>
                    <f:facet name="header">
                        <a:commandLink action="#{userSearch.sortBy('username')}" tabindex="20" reRender="dialogOwnerSelectionContent"
                                       oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')">
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.up.gif" width="8" height="8"
                                            rendered="#{!userSearch.orderDescending and userSearch.orderByProperty == 'username'}"/>
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.down.gif" width="8" height="8"
                                            rendered="#{userSearch.orderDescending and userSearch.orderByProperty == 'username'}"/>
                            Username
                        </a:commandLink>
                    </f:facet>
                    #{u.username}
                    <h:outputText rendered="#{!empty u.activationCode}">&#160;(Not Activated)</h:outputText>
                </h:column>

                <h:column>
                    <f:facet name="header">
                        <a:commandLink action="#{userSearch.sortBy('firstname')}" tabindex="20" reRender="dialogOwnerSelectionContent"
                                       oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')">
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.up.gif" width="8" height="8"
                                            rendered="#{!userSearch.orderDescending and userSearch.orderByProperty == 'firstname'}"/>
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.down.gif" width="8" height="8"
                                            rendered="#{userSearch.orderDescending and userSearch.orderByProperty == 'firstname'}"/>
                            First name
                        </a:commandLink>
                    </f:facet>
                    #{u.firstname}
                </h:column>

                <h:column>
                    <f:facet name="header">
                        <a:commandLink action="#{userSearch.sortBy('lastname')}" tabindex="20" reRender="dialogOwnerSelectionContent"
                                       oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')">
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.up.gif" width="8" height="8"
                                            rendered="#{!userSearch.orderDescending and userSearch.orderByProperty == 'lastname'}"/>
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.down.gif" width="8" height="8"
                                            rendered="#{userSearch.orderDescending and userSearch.orderByProperty == 'lastname'}"/>
                            Last name
                        </a:commandLink>
                    </f:facet>
                    #{u.lastname}
                </h:column>

                <h:column>
                    <f:facet name="header">
                        <a:commandLink action="#{userSearch.sortBy('email')}" tabindex="20" reRender="dialogOwnerSelectionContent"
                                       oncomplete="jQuery('#dialogOwnerSelection').jqmAddClose('.closeDialog')">
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.up.gif" width="8" height="8"
                                            rendered="#{!userSearch.orderDescending and userSearch.orderByProperty == 'email'}"/>
                            <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/sortindicator.down.gif" width="8" height="8"
                                            rendered="#{userSearch.orderDescending and userSearch.orderByProperty == 'email'}"/>
                            E-mail address
                        </a:commandLink>
                    </f:facet>
                    #{u.email}
                </h:column>

                <h:column>
                    <a:commandLink action="#{home.selectOwner(u.id)}"
                                   reRender="ownerDisplay" styleClass="buttonNonpersistent closeDialog"
                                   tabindex="20"><span class="buttonLabel">Select</span></a:commandLink>
                </h:column>

            </h:dataTable>
        </s:div>
        </h:form>

    </ui:define>

</ui:decorate>
