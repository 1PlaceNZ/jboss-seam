<s:div id="preferencesForm"
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:a="https://ajax4jsf.dev.java.net/ajax"
        xmlns:s="http://jboss.com/products/seam/taglib">

    <h:panelGrid columns="2" columnClasses="formListGridColumn">

        <a:region>
        <h:dataTable id="preferenceComponentList" var="prefComp"
                     value="#{preferenceComponents}"
                     styleClass="formListTable  sessionEventTrigger"
                     cellpadding="0" cellspacing="0" border="0"
                     columnClasses="formListItem">

            <h:column>
                <a:commandLink action="#{preferenceEditor.selectPreferenceComponent(prefComp)}"
                               reRender="preferenceComponentList, propertyPanel" oncomplete="onAjaxRequestComplete()"
                               styleClass="#{prefComp == preferenceEditor.preferenceComponent ? 'selectedItem' : ''}">
                        #{prefComp.description}
                </a:commandLink>
            </h:column>

        </h:dataTable>
        </a:region>

        <s:div id="propertyPanel">

            <a:region>
            <h:dataTable id="propertyTable" var="v"
                         rendered="#{not empty preferenceEditor.preferenceComponent}"
                         value="#{preferenceEditor.preferenceValues}"
                         styleClass="datatable topLeftBottomBorder rightBorder sessionEventTrigger"
                         columnClasses="twentyPercentColumn alignLeft minorPadding,
                                        twentyPercentColumn alignLeft, defaultColumn alignCenter rightBorder"
                         rowClasses="rowEven,rowOdd"
                         cellpadding="0" cellspacing="0" border="0">

                <h:column>
                    <h:outputText value="#{v.preferenceProperty.description}"/>
                </h:column>
                <h:column>

                    <s:div rendered="#{v.preferenceProperty.type.simpleName == 'Boolean'}">
                        <h:selectBooleanCheckbox value="#{v.value}"/>
                    </s:div>

                    <s:div rendered="#{v.preferenceProperty.type.simpleName == 'String'}">
                        <h:inputText styleClass="ajaxSupport" value="#{v.value}" size="25" rendered="#{!v.preferenceProperty.longStringAllowed}">
                            <a:support event="onblur" action="#{preferenceEditor.validate}" oncomplete="onAjaxRequestComplete()"
                                       reRender="preferenceValidationErrors, preferenceComponentList"/>
                        </h:inputText>
                        <h:inputTextarea value="#{v.value}" rows="10" cols="35" style="margin:5px;" rendered="#{v.preferenceProperty.longStringAllowed}">
                            <a:support event="onblur" action="#{preferenceEditor.validate}"
                                       reRender="preferenceValidationErrors, preferenceComponentList"/>
                        </h:inputTextarea>
                    </s:div>

                    <s:div rendered="#{v.preferenceProperty.type.simpleName == 'Long'}">
                        <h:inputText styleClass="ajaxSupport" value="#{v.value}" size="5">
                            <f:converter converterId="javax.faces.Long"/>
                            <a:support event="onblur" action="#{preferenceEditor.validate}" oncomplete="onAjaxRequestComplete()"
                                       reRender="preferenceValidationErrors, preferenceComponentList, propertyPanel"/>
                        </h:inputText>
                    </s:div>

                    <s:div rendered="#{v.preferenceProperty.type.simpleName == 'Double'}">
                        <h:inputText styleClass="ajaxSupport" value="#{v.value}" size="10">
                            <f:converter converterId="javax.faces.Double"/>
                            <a:support event="onblur" action="#{preferenceEditor.validate}" oncomplete="onAjaxRequestComplete()"
                                       reRender="preferenceValidationErrors, preferenceComponentList"/>
                        </h:inputText>
                    </s:div>

                    <s:div rendered="#{v.preferenceProperty.type.simpleName == 'Date'}">
                         <h:inputText styleClass="ajaxSupport" id="dt" value="#{v.value}">
                            <f:convertDateTime pattern="dd. MMM yyyy, HH:mm" timeZone="#{wikiPreferences.timeZone}"/>
                             <a:support event="onblur" action="#{preferenceEditor.validate}" oncomplete="onAjaxRequestComplete()"
                                        reRender="preferenceValidationErrors, preferenceComponentList"/>
                        </h:inputText>
                        <s:selectDate for="dt" dateFormat="dd. MMM yyyy, HH:mm">
                            <h:graphicImage style="vertical-align:bottom;margin-bottom:2px;"
                                            value="/themes/#{wikiPreferences.themeName}/img/icon.calendar.gif"
                                            width="16" height="16"/>
                        </s:selectDate>
                    </s:div>

                </h:column>
            </h:dataTable>
            </a:region>

        </s:div>

        <s:div id="preferenceValidationErrors">
            <s:span rendered="#{!preferenceEditor.valid}">
                <span id="preferenceValidationErrorMessage" style="display:none"><h:message for="preferenceValidationErrors"/></span>
                <script type="text/javascript">jQuery(function() {
                    formTabRaiseError("#{tabId}", "prefEditor", "Preferences, " + jQuery("#preferenceValidationErrorMessage").html())
                });</script>
            </s:span>
            <s:span rendered="#{preferenceEditor.valid}">
                <script type="text/javascript">jQuery(function() {
                    formTabClearError("#{tabId}", "prefEditor");
                });</script>
            </s:span>
        </s:div>

    </h:panelGrid>

</s:div>