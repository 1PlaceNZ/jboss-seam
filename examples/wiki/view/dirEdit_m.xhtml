<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:wiki="http://jboss.com/products/seam/wiki"
                template="themes/#{wikiPreferences.themeName}/#{skin}/template.xhtml">

<ui:define name="screenname">
    <h:outputText value="Create directory" rendered="#{!directoryHome.managed}"/>
    <h:outputText value="Edit directory" rendered="#{directoryHome.managed}"/>
</ui:define>

<ui:define name="control">

    <s:link id="exitManaged" styleClass="linkNavigation" rendered="#{directoryHome.managed}" action="exitManaged">Exit Editor</s:link>

    <s:link id="exitUnmanaged" styleClass="linkNavigation" rendered="#{!directoryHome.managed}" action="exitUnmanaged">Exit Editor</s:link>

</ui:define>

<ui:define name="content">

    <h:form><s:validateAll>

        <s:div rendered="#{!empty directoryHome.parentDirectory}">Parent:&#160;#{directoryHome.parentDirectory.name}</s:div>
        <div class="errorMessage"><h:message for="name"/></div>
        <div>Name:&#160;
            <h:inputText id="name" size="30" maxlength="255" required="true" value="#{directoryHome.instance.name}"/>
        </div>
        <div class="errorMessage"><h:message for="description"/></div>
        <div>Description:&#160;
            <h:inputText id="description" size="30" maxlength="512" required="false" value="#{directoryHome.instance.description}"/>
        </div>
        <div>Default Document:&#160;
            <h:selectOneMenu value="#{directoryHome.instance.defaultDocument}" converter="#{restrictedEntityConverter}">
                <s:selectItems value="#{directoryHome.childDocuments}"
                               var="document"
                               label="#{wiki:truncateString(document.name, 40, '...')}"
                               noSelectionLabel="No default document"/>
            </h:selectOneMenu>
        </div>
        <div>
            <h:selectBooleanCheckbox value="#{directoryHome.hasFeed}"
                                     disabled="#{empty directoryHome.parentDirectory}"/>
            &#160;Enable syndication feed (disabling invalidates subcriber link)

        </div>

        <s:div styleClass="formControls">
            <h:commandButton action="#{directoryHome.persist}" rendered="#{!directoryHome.managed}" value="Save"/>
            <h:commandButton action="#{directoryHome.update}" rendered="#{directoryHome.managed}" value="Update"/>
            <h:commandButton action="#{directoryHome.remove}"
                             rendered="#{empty directoryHome.instance.children
                                        and directoryHome.managed
                                        and !empty directoryHome.parentDirectory
                                        and directoryHome.instance.id != wikiPreferences.memberAreaId}" value="Delete"/>
        </s:div>

    </s:validateAll></h:form>

</ui:define>

</ui:composition>
