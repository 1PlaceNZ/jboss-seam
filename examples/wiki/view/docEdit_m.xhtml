<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:wiki="http://jboss.com/products/seam/wiki"
                template="themes/#{wikiPreferences.themeName}/#{skin}/template.xhtml">

<ui:define name="screenname">
    <h:outputText value="Create document" rendered="#{!documentHome.managed}"/>
    <h:outputText value="Edit document" rendered="#{documentHome.managed}"/>
</ui:define>

<ui:define name="control">

    <s:link id="exitManaged" styleClass="linkNavigation" rendered="#{documentHome.managed}" action="exitManaged">Exit Editor</s:link>

    <s:link id="exitUnmanaged" styleClass="linkNavigation" rendered="#{!documentHome.managed}" action="exitUnmanaged">Exit Editor</s:link>
    
</ui:define>

<ui:define name="content">

    <h:form><s:validateAll>

        <div>Directory:&#160;#{documentHome.parentDirectory.name}</div>
        <div class="errorMessage"><h:message for="name"/></div>
        <div>Name:&#160;
            <h:inputText id="name" size="30" maxlength="255" required="true" value="#{documentHome.instance.name}"/>
        </div>
        <div>
            <h:selectBooleanCheckbox value="#{documentHome.instance.nameAsTitle}"/>
            &#160;Render name as document title
        </div>
        <div>
            <h:selectBooleanCheckbox value="#{documentHome.minorRevision}"/>
            &#160;Minor change, don't create a new revision
        </div>

        <s:fragment rendered="#{not documentHome.managed}">
            <div>
                <h:selectBooleanCheckbox value="#{documentHome.pushOnFeeds}">
                </h:selectBooleanCheckbox>
                &#160;Create entry on parent directory feeds
            </div>
            <div>
                <h:selectBooleanCheckbox value="#{documentHome.pushOnSiteFeed}"/>
                &#160;Create entry on global site feed (requires entry on parent feeds)
            </div>
        </s:fragment>

        <s:fragment rendered="#{documentHome.managed}">
            <s:fragment rendered="#{documentHome.siteFeedEntryPresent}">
                <div>
                    <h:selectBooleanCheckbox value="#{documentHome.pushOnFeeds}"/>
                    &#160;Push changes onto feeds
                </div>
            </s:fragment>
            <s:fragment rendered="#{not documentHome.siteFeedEntryPresent}">
                <s:div styleClass="entry">
                    <div>
                        <h:selectBooleanCheckbox value="#{documentHome.pushOnFeeds}"/>
                        Push changes onto feeds of parent directories
                    </div>
                </s:div>
                <s:div id="pushOnSiteFeedSwitch">
                    <div>
                        <h:selectBooleanCheckbox value="#{documentHome.pushOnSiteFeed}"/>
                        &#160;Create entry on  global site feed (requires changes on parent feeds)
                    </div>
                </s:div>
            </s:fragment>
        </s:fragment>

        <div class="errorMessage"><h:message for="contentTextArea"/></div>
        <div>
            <h:inputTextarea required="true"
                             cols="45"
                             rows="15"
                             id="contentTextArea"
                             value="#{documentHome.formContent}"/>
        </div>

        <s:div styleClass="formControls">
            <h:commandButton action="#{documentHome.persist}" rendered="#{!documentHome.managed}" value="Save"/>
            <h:commandButton action="#{documentHome.update}" rendered="#{documentHome.managed}" value="Update"/>
            <h:commandButton action="#{documentHome.remove}" rendered="#{documentHome.managed and documentHome.instance.id != wikiStart.id}" value="Delete"/>
        </s:div>

    </s:validateAll></h:form>

</ui:define>

</ui:composition>
