<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:wiki="http://jboss.com/products/seam/wiki"
      xmlns:s="http://jboss.com/products/seam/taglib">

<f:view contentType="text/html"/>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>LaceWiki&#160;-&#160;
        <ui:insert name="screenname"/>
    </title>
    <link href="#{themePath}/css/template.css" rel="stylesheet" type="text/css"/>
    <ui:insert name="includeHeaders"/>

    <script type="text/javascript">
        function clickClear(thisfield, defaulttext) {
            if (thisfield.value == defaulttext) {
                thisfield.value = "";
            }
        }
        function clickRecall(thisfield, defaulttext) {
            if (thisfield.value == '') {
                thisfield.value = defaulttext;
            }
        }
        function jsf(id) {
            // Find the dynamic JSF client identifier by looking up
            // the static identifier of its j4j proxy child element
            var realId = document.getElementById(id).title;
            //alert("FOR: '" + id + "' FOUND: '"+ realId + "'");
            var element = document.getElementById(realId);
            return jQuery(element);
        }
        var fadeInPopupDialog = function(hash) {
            hash.w.fadeIn('fast',function(){ hash.o.show(); });
            jQuery(".closeDialog", hash.w).attr("accesskey", "C"); // Dynamically assign accesskey
        };
        var fadeOutPopupDialog = function(hash) { hash.w.fadeOut('fast',function(){ hash.o.remove(); }); };
    </script>
    <script type="text/javascript" src="#{themePath}/js/jquery.js"></script>
    <script type="text/javascript" src="#{themePath}/js/interface.js"></script>
    <script type="text/javascript" src="#{themePath}/js/jqModal.js"></script>
    <script type="text/javascript" src="#{themePath}/js/jqTabs.js"></script>
    <script type="text/javascript" src="#{themePath}/js/jqHistoryRemote.js"></script>
    <script type="text/javascript">
        jQuery.noConflict(); // Avoid conflicts with the RichFaces/Prototype library
    </script>
</head>

<body>

<s:div id="screen">

    <s:div id="header">
        <div id="headerTopLeft">
            <div class="screenname">
                LaceWiki:&#160;<ui:insert name="screenname"/>
            </div>
        </div>
        <div id="headerTopRight">
            <ui:insert name="headerTopRight"/>
        </div>
        <div id="headerBottomLeft">
            <ui:insert name="headerBottomLeft"/>
        </div>
        <div id="headerBottomRight">
            <ui:insert name="headerBottomRight"/>
        </div>
    </s:div>

    <s:div id="control">
        <div id="controlLeft"><ui:insert name="controlLeft"/></div>
        <div id="controlRight">&#160;
            <h:form id="workspaceSwitcher" rendered="#{wiki:sizeOf(conversationList) > 0}">
                <h:selectOneMenu value="#{switcher.conversationIdOrOutcome}"
                                 styleClass="workspaceSwitcherCombobox">
                    <f:selectItems value="#{switcher.selectItems}"/>
                </h:selectOneMenu>
                <h:commandLink action="#{switcher.select}" accesskey="W"
                             styleClass="linkNavigation">Switch <u>W</u>orkspace</h:commandLink>

            </h:form><ui:insert name="controlRight"/></div>
    </s:div>

    <div id="controlSeparator">&#160;</div>

    <s:div id="sidebar">
        <ui:insert name="sidebar"/>
    </s:div>

    <s:div id="body">
        <s:div id="messageBox">
        <s:div rendered="#{!empty facesMessages.currentGlobalMessages}">
            <ui:repeat var="message" value="#{facesMessages.currentGlobalMessages}">
                <h:panelGrid columns="2">
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/info.gif"
                                    width="18" height="18"
                                    styleClass="infoImage"/>
                    <h:outputText styleClass="infoMessage" value="#{message.summary}"/>
                </h:panelGrid>
                <!-- TODO: Well, how do we do that in EL without static stuff?! #{message.severity == 'Warn' or message.severity == 'Error'}
                <h:panelGrid columns="2" rendered="false">
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/attention.gif"
                                    width="18" height="18"
                                    styleClass="attentionImage"/>
                    <h:outputText styleClass="attentionMessage" value="#{message.summary}"/>
                </h:panelGrid>
                -->
            </ui:repeat>
        </s:div>
        </s:div>
        <div id="content">
            <f:facet name="beforeInvalidField">
                <h:panelGroup>
                    <h:graphicImage value="/themes/#{wikiPreferences.themeName}/img/attention.gif"
                                    width="18" height="18"
                                    styleClass="attentionImage"/>
                    <s:span styleClass="attentionMessage">&#160;
                        <s:message/>
                    </s:span>
                </h:panelGroup>
            </f:facet>
            <f:facet name="aroundInvalidField">
                <s:div styleClass="errorDiv"/>
            </f:facet>
            <ui:insert name="content"/>
        </div>
    </s:div>

    <div id="footer">
        <ui:insert name="footer"/>
        <div align="right" style="font-size:smaller;">
            LaceWiki is using
            <a href="http://www.jboss.com/products/seam">JBoss Seam</a> and
            running on <a href="http://www.jboss.org/products/jbossas">JBoss Application Server</a>.
        </div>
    </div>

    <!-- Remove this to disable Facelets JSF debugging
    <ui:debug hotkey="D"/>
    -->

</s:div>

</body>
</html>
