<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pages PUBLIC "-//Seam/Seam Pages DTD 1.1//EN" "http://jboss.com/products/seam/pages-1.1.dtd">

<pages>

    <page view-id="/doc/browse.xhtml" action="#{browser.prepareAndCapture()}">
        <param name="nodeId" value="#{browser.nodeId}"/>

        <navigation>
            <rule if="#{!empty currentDocument}">
                <render view-id="/docDisplay.xhtml"/>
            </rule>
            <rule>
                <render view-id="/dirBrowser.xhtml"/>
            </rule>
        </navigation>
        
    </page>

    <page view-id="/doc/edit.xhtml" action="#{browser.prepare()}">
        <param name="nodeId" value="#{browser.nodeId}"/>
        <navigation>
            <redirect view-id="/docEdit.xhtml">
                <param name="docId"         value="#{currentDocument.id}"/>
                <param name="parentDirId"   value="#{currentDirectory.id}"/>
            </redirect>
        </navigation>
    </page>

    <!--
    <page view-id="/docDisplay.xhtml" action="#{documentBrowser.prepare()}">
        <param name="docId" value="#{documentBrowser.docId}"/>

        <navigation>
            <rule if-outcome="browseDir" if="#{!empty currentDirectory}">
                <redirect view-id="/dirBrowser.xhtml">
                    <param name="dirId" value="#{currentDirectory.id}"/>
                </redirect>
            </rule>
            <rule if-outcome="browseDir">
                <redirect view-id="/dirBrowser.xhtml"/>
            </rule>
            <rule if-outcome="createDoc">
                <redirect view-id="/docEdit.xhtml">
                    <param name="dirId" value="#{currentDirectory.id}"/>
                </redirect>
            </rule>
            <rule if-outcome="editDoc">
                <redirect view-id="/docEdit.xhtml">
                    <param name="dirId" value="#{currentDirectory.id}"/>
                    <param name="docId" value="#{currentDocument.id}"/>
                </redirect>
            </rule>
        </navigation>

    </page>

    <page view-id="/docEdit.xhtml">

        <navigation from-action="#{documentHome.remove}">
            <end-conversation/>
            <redirect view-id="/dirBrowser.xhtml">
                <param name="dirId" value="#{currentDirectory.id}"/>
            </redirect>
        </navigation>

    </page>

    <page view-id="/dirBrowser.xhtml" action="#{directoryBrowser.prepare()}">
        <param name="dirId" value="#{directoryBrowser.dirId}" converterId="javax.faces.Long"/>

        <navigation>
            <rule if-outcome="createDir">
                <redirect view-id="/dirEdit.xhtml">
                    <param name="parentDirectoryId" value="#{currentDirectory.id}"/>
                </redirect>
            </rule>
            <rule if-outcome="editDir">
                <redirect view-id="/dirEdit.xhtml">
                    <param name="dirId" value="#{currentDirectory.id}"/>
                </redirect>
            </rule>
            <rule if-outcome="createDoc">
                <redirect view-id="/docEdit.xhtml">
                    <param name="dirId" value="#{currentDirectory.id}"/>
                </redirect>
            </rule>
            <rule if-outcome="editDoc">
                <redirect view-id="/docEdit.xhtml">
                    <param name="docId" value="#{param.docId}"/>
                    <param name="dirId" value="#{currentDirectory.id}"/>
                </redirect>
            </rule>
        </navigation>

    </page>

    <page view-id="/dirEdit.xhtml">

        <navigation from-action="#{directoryHome.remove}">
            <rule if="#{!empty directoryHome.parentDirectory}">
                <end-conversation/>
                <redirect view-id="/dirBrowser.xhtml">
                    <param name="dirId" value="#{directoryHome.parentDirectory.id}"/>
                </redirect>
            </rule>
            <rule>
                <end-conversation/>
                <redirect view-id="/dirBrowser.xhtml"/>
            </rule>
        </navigation>

    </page>
-->

</pages>


