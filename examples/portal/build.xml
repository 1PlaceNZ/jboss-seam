<?xml version="1.0"?>

<project name="Portal Booking" default="deploy" basedir=".">

    <!-- Naming -->
    <property name="Name"                   value="Seam on JBoss Portal/Hibernate3 Example"/>
    <property name="example.name"           value="jboss-seam-portal"/>
    
    <!-- Overrides -->
    <property name="unit.ext"                value="war" />
    <property name="example.seam.ui.lib"     value="yes"/>
    <property name="example.seam.debug.lib"  value="yes"/>
    <property name="example.facelets.lib"    value="yes"/>
    <property name="example.ds"              value="portal-ds.xml"/>
    <property name="src.java.dir"            value="src"/>
    <property name="src.test.dir"            value="src"/>
    <property name="test.classpath"          value="test.eejb.classpath"/>
    <property name="tomcat.conf"             value="eejb.conf"/>

    <property name="example.webinf.lib.dir" value="" />

    <import file="../../build.xml"/>

    <target name="ear" depends="ejb3, war" />



    <target name="war" depends="compile">
        <jar jarfile="${build.dir}/${example.name}.jar">
            <fileset refid="example.classes"/>
            <fileset dir="resources">
                <include name="seam.properties"/>
                <include name="import.sql"/>
                <include name="hibernate.cfg.xml"/>
            </fileset>
        </jar>
        

        <copy todir="${build.dir}/resources/WEB-INF">
            <fileset refid="example.war.webinf"/>
            <filterset>
                <filter token="jndiPattern" value="${example.name}/#{ejbName}/local"/>
                <filter token="embeddedEjb" value="false"/>
                <filter token="microcontainer" value="false"/>
            </filterset>
        </copy>


        <jar destfile="${build.dir}/${example.name}.war">
            <zipfileset refid="example.tomcat.seam.jar"/>
            <zipfileset refid="example.war.docroot"/>
            <zipfileset refid="example.war.webinf.lib"/>
            <zipfileset refid="example.facelets.jar"/>
            <zipfileset refid="example.extra.jar"/>
            <zipfileset dir="${lib.dir}" prefix="WEB-INF/lib">
                <include name="el-*.jar"/>
            </zipfileset>
            <zipfileset dir="${build.dir}/resources">
                <include name="WEB-INF/**/*.*"/>
            </zipfileset>
            <zipfileset dir="${build.dir}" prefix="WEB-INF/lib">
                <include name="${example.name}.jar"/>
            </zipfileset>
        </jar>

    </target>

</project>
