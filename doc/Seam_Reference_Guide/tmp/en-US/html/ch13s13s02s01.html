<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head xmlns="http://www.w3.org/1999/xhtml">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>13.13.2.1. Password hashing</title>
    <link rel="stylesheet" href="./Common_Content/css/default.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.72.0" />
    <link rel="start" href="index.html" title="Seam - Contextual Components" />
    <link rel="up" href="ch13s13s02.html" title="13.13.2. JPAIdentityStore" />
    <link rel="prev" href="ch13s13s02.html" title="13.13.2. JPAIdentityStore" />
    <link rel="next" href="ch13s13s03.html" title="13.13.3. Authentication with the Identity Management API" />
  </head>
  <body>
    <p xmlns="http://www.w3.org/1999/xhtml" id="title">
      <a href="http://www.redhat.com/docs">
        <strong>13.13.2.1. Password hashing</strong>
      </a>
    </p>
    <ul xmlns="http://www.w3.org/1999/xhtml" class="docnav">
      <li class="previous">
        <a accesskey="p" href="ch13s13s02.html">
          <strong>Prev</strong>
        </a>
      </li>
      <li class="next">
        <a accesskey="n" href="ch13s13s03.html">
          <strong>Next</strong>
        </a>
      </li>
    </ul>
    <div xmlns="http://www.w3.org/1999/xhtml" class="sect3" lang="en-US" xml:lang="en-US">
      <div class="titlepage">
        <div>
          <div>
            <h4 class="title"><a id="id2835832"></a>13.13.2.1. Password hashing</h4>
          </div>
        </div>
      </div>
      <p>
		The <code class="literal">JPAIdentityStore</code> stores a salted hash of the user's password, using the username as the source material for salt generation. This guarantees that two users with the same password will still have different password hashes. The method for generating a password hash is listed here for convenience - it may be useful for generating password hashes for inclusion in DML scripts, etc:
	</p>
      <pre class="programlisting">
   public String hashPassword(String password, String saltPhrase)
   {
      try {
         MessageDigest md = MessageDigest.getInstance("MD5");
         
         md.update(saltPhrase.getBytes());
         byte[] salt = md.digest();
         
         md.reset();
         md.update(password.getBytes("UTF-8"));
         md.update(salt);
         
         byte[] raw = md.digest();
         
         return new String(Hex.encodeHex(raw));
     } 
     catch (Exception e) {
         throw new RuntimeException(e);        
     }      
   }         

</pre>
    </div>
    <ul xmlns="http://www.w3.org/1999/xhtml" class="docnav">
      <li class="previous">
        <a accesskey="p" href="ch13s13s02.html"><strong>Prev</strong>13.13.2. JPAIdentityStore</a>
      </li>
      <li class="up">
        <a accesskey="u" href="#">
          <strong>Up</strong>
        </a>
      </li>
      <li class="home">
        <a accesskey="h" href="index.html">
          <strong>Home</strong>
        </a>
      </li>
      <li class="next">
        <a accesskey="n" href="ch13s13s03.html"><strong>Next</strong>13.13.3. Authentication with the Identity Managem...</a>
      </li>
    </ul>
  </body>
</html>
