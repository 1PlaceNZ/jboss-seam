<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head xmlns="http://www.w3.org/1999/xhtml">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>7.1.2. Seam and the back button</title>
    <link rel="stylesheet" href="./Common_Content/css/default.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.72.0" />
    <link rel="start" href="index.html" title="Seam - Contextual Components" />
    <link rel="up" href="ch07s01.html" title="7.1. Pageflow in Seam" />
    <link rel="prev" href="ch07s01s01.html" title="7.1.1. The two navigation models" />
    <link rel="next" href="ch07s02.html" title="7.2. Using jPDL pageflows" />
  </head>
  <body>
    <p xmlns="http://www.w3.org/1999/xhtml" id="title">
      <a href="http://www.redhat.com/docs">
        <strong>7.1.2. Seam and the back button</strong>
      </a>
    </p>
    <ul xmlns="http://www.w3.org/1999/xhtml" class="docnav">
      <li class="previous">
        <a accesskey="p" href="ch07s01s01.html">
          <strong>Prev</strong>
        </a>
      </li>
      <li class="next">
        <a accesskey="n" href="ch07s02.html">
          <strong>Next</strong>
        </a>
      </li>
    </ul>
    <div xmlns="http://www.w3.org/1999/xhtml" class="section" lang="en-US" xml:lang="en-US">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title"><a id="id2789004"></a>7.1.2. Seam and the back button</h3>
          </div>
        </div>
      </div>
      <p>
				When JSF or Seam navigation rules are used, Seam lets the user freely navigate via the back, forward and refresh buttons. It is the responsibility of the application to ensure that conversational state remains internally consistent when this occurs. Experience with the combination of web application frameworks like Struts or WebWork - that do not support a conversational model - and stateless component models like EJB stateless session beans or the Spring framework has taught many developers that this is close to impossible to do! However, our experience is that in the context of Seam, where there is a well-defined conversational model, backed by stateful session beans, it is actually quite straightforward. Usually it is as simple as combining the use of <code class="literal">no-conversation-view-id</code> with null checks at the beginning of action listener methods. We consider support for freeform navigation to be almost always desirable.
			</p>
      <p>
				In this case, the <code class="literal">no-conversation-view-id</code> declaration goes in <code class="literal">pages.xml</code>. It tells Seam to redirect to a different page if a request originates from a page rendered during a conversation, and that conversation no longer exists:
			</p>
      <pre class="programlisting">&lt;page view-id="/checkout.xhtml" 
        no-conversation-view-id="/main.xhtml"/&gt;
</pre>
      <p>
				On the other hand, in the stateful model, backbuttoning is interpreted as an undefined transition back to a previous state. Since the stateful model enforces a defined set of transitions from the current state, back buttoning is by default disallowed in the stateful model! Seam transparently detects the use of the back button, and blocks any attempt to perform an action from a previous, "stale" page, and simply redirects the user to the "current" page (and displays a faces message). Whether you consider this a feature or a limitation of the stateful model depends upon your point of view: as an application developer, it is a feature; as a user, it might be frustrating! You can enable backbutton navigation from a particular page node by setting <code class="literal">back="enabled"</code>.
			</p>
      <pre class="programlisting">&lt;page name="checkout" 
        view-id="/checkout.xhtml" 
        back="enabled"&gt;
    &lt;redirect/&gt;
    &lt;transition to="checkout"/&gt;
    &lt;transition name="complete" to="complete"/&gt;
&lt;/page&gt;
</pre>
      <p>
				This allows backbuttoning <span class="emphasis"><em>from</em></span> the <code class="literal">checkout</code> state to <span class="emphasis"><em>any previous state!</em></span>
			</p>
      <p>
				Of course, we still need to define what happens if a request originates from a page rendered during a pageflow, and the conversation with the pageflow no longer exists. In this case, the <code class="literal">no-conversation-view-id</code> declaration goes into the pageflow definition:
			</p>
      <pre class="programlisting">&lt;page name="checkout" 
        view-id="/checkout.xhtml" 
        back="enabled" 
        no-conversation-view-id="/main.xhtml"&gt;
    &lt;redirect/&gt;
    &lt;transition to="checkout"/&gt;
    &lt;transition name="complete" to="complete"/&gt;
&lt;/page&gt;
</pre>
      <p>
				In practice, both navigation models have their place, and you'll quickly learn to recognize when to prefer one model over the other.
			</p>
    </div>
    <ul xmlns="http://www.w3.org/1999/xhtml" class="docnav">
      <li class="previous">
        <a accesskey="p" href="ch07s01s01.html"><strong>Prev</strong>7.1.1. The two navigation models</a>
      </li>
      <li class="up">
        <a accesskey="u" href="#">
          <strong>Up</strong>
        </a>
      </li>
      <li class="home">
        <a accesskey="h" href="index.html">
          <strong>Home</strong>
        </a>
      </li>
      <li class="next">
        <a accesskey="n" href="ch07s02.html"><strong>Next</strong>7.2. Using jPDL pageflows</a>
      </li>
    </ul>
  </body>
</html>
