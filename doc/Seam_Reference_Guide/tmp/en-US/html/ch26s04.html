<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head xmlns="http://www.w3.org/1999/xhtml">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>26.4. Annotations for context demarcation</title>
    <link rel="stylesheet" href="./Common_Content/css/default.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.72.0" />
    <link rel="start" href="index.html" title="Seam - Contextual Components" />
    <link rel="up" href="annotations.html" title="Chapter 26. Seam annotations" />
    <link rel="prev" href="ch26s03.html" title="26.3. Annotations for component lifecycle methods" />
    <link rel="next" href="ch26s05.html" title="26.5. Annotations for use with Seam JavaBean components in a J2EE environment" />
  </head>
  <body>
    <p xmlns="http://www.w3.org/1999/xhtml" id="title">
      <a href="http://www.redhat.com/docs">
        <strong>26.4. Annotations for context demarcation</strong>
      </a>
    </p>
    <ul xmlns="http://www.w3.org/1999/xhtml" class="docnav">
      <li class="previous">
        <a accesskey="p" href="ch26s03.html">
          <strong>Prev</strong>
        </a>
      </li>
      <li class="next">
        <a accesskey="n" href="ch26s05.html">
          <strong>Next</strong>
        </a>
      </li>
    </ul>
    <div xmlns="http://www.w3.org/1999/xhtml" class="section" lang="en-US" xml:lang="en-US">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a id="id2886337"></a>26.4. Annotations for context demarcation</h2>
          </div>
        </div>
      </div>
      <p>
			These annotations provide declarative conversation demarcation. They appear on methods of Seam components, usually action listener methods.
		</p>
      <p>
			Every web request has a conversation context associated with it. Most of these conversations end at the end of the request. If you want a conversation that span multiple requests, you must "promote" the current conversation to a <span class="emphasis"><em>long-running conversation</em></span> by calling a method marked with <code class="literal">@Begin</code>.
		</p>
      <p>
			</p>
      <div class="orderedlist">
        <a id="begin-annotation"></a>
        <ol>
          <li>
            <p>
						<code class="literal">@Begin</code>
					</p>
            <div class="itemizedlist">
              <ul>
                <li>
                  <p>
</p>
                  <pre class="programlisting">@Begin
</pre>
                  <p>
								 Specifies that a long-running conversation begins when this method returns a non-null outcome without exception.
							</p>
                </li>
                <li>
                  <p>
</p>
                  <pre class="programlisting">@Begin(join=true)
</pre>
                  <p>
								 Specifies that if a long-running conversation is already in progress, the conversation context is simply propagated.
							</p>
                </li>
                <li>
                  <p>
</p>
                  <pre class="programlisting">@Begin(nested=true)
</pre>
                  <p>
								 Specifies that if a long-running conversation is already in progress, a new <span class="emphasis"><em>nested</em></span> conversation context begins. The nested conversation will end when the next <code class="literal">@End</code> is encountered, and the outer conversation will resume. It is perfectly legal for multiple nested conversations to exist concurrently in the same outer conversation.
							</p>
                </li>
                <li>
                  <p>
</p>
                  <pre class="programlisting">@Begin(pageflow="process definition name")
</pre>
                  <p>
								 Specifies a jBPM process definition name that defines the pageflow for this conversation.
							</p>
                </li>
                <li>
                  <p>
</p>
                  <pre class="programlisting">@Begin(flushMode=FlushModeType.MANUAL)
</pre>
                  <p>
								 Specify the flush mode of any Seam-managed persistence contexts. <code class="literal">flushMode=FlushModeType.MANUAL</code> supports the use of <span class="emphasis"><em>atomic conversations</em></span> where all write operations are queued in the conversation context until an explicit call to <code class="literal">flush()</code> (which usually occurs at the end of the conversation).
							</p>
                </li>
              </ul>
            </div>
          </li>
        </ol>
      </div>
      <p>
			</p>
      <div class="itemizedlist">
        <ul>
          <li>
            <p>
						<code class="literal">join</code> — determines the behavior when a long-running conversation is already in progress. If <code class="literal">true</code>, the context is propagated. If <code class="literal">false</code>, an exception is thrown. Default to <code class="literal">false</code>. This setting is ignored when <code class="literal">nested=true</code> is specified
					</p>
          </li>
          <li>
            <p>
						<code class="literal">nested</code> — specifies that a nested conversation should be started if a long-running conversation is already in progress.
					</p>
          </li>
          <li>
            <p>
						<code class="literal">flushMode</code> — set the flush mode of any Seam-managed Hibernate sessions or JPA persistence contexts that are created during this conversation.
					</p>
          </li>
          <li>
            <p>
						<code class="literal">pageflow</code> — a process definition name of a jBPM process definition deployed via <code class="literal">org.jboss.seam.bpm.jbpm.pageflowDefinitions.</code>
					</p>
          </li>
        </ul>
      </div>
      <p>
		</p>
      <p>
			</p>
      <div class="variablelist">
        <dl>
          <dt>
            <a id="end-annotation"></a>
            <span class="term">
              <code class="literal">@End</code>
            </span>
          </dt>
          <dd>
            <p>
</p>
            <pre class="programlisting">@End
</pre>
            <p>
							 Specifies that a long-running conversation ends when this method returns a non-null outcome without exception.
						</p>
            <div class="itemizedlist">
              <ul>
                <li>
                  <p>
									<code class="literal">beforeRedirect</code> — by default, the conversation will not actually be destroyed until after any redirect has occurred. Setting <code class="literal">beforeRedirect=true</code> specifies that the conversation should be destroyed at the end of the current request, and that the redirect will be processed in a new temporary conversation context.
								</p>
                </li>
              </ul>
            </div>
          </dd>
          <dt>
            <a id="starttask-annotation"></a>
            <span class="term">
              <code class="literal">@StartTask</code>
            </span>
          </dt>
          <dd>
            <p>
</p>
            <pre class="programlisting">@StartTask
</pre>
            <p>
							 "Starts" a jBPM task. Specifies that a long-running conversation begins when this method returns a non-null outcome without exception. This conversation is associated with the jBPM task specified in the named request parameter. Within the context of this conversation, a business process context is also defined, for the business process instance of the task instance.
						</p>
            <div class="itemizedlist">
              <ul>
                <li>
                  <p>
									The jBPM <code class="literal">TaskInstance</code> will be available in a request context variable named <code class="literal">taskInstance</code>. The jPBM <code class="literal">ProcessInstance</code> will be available in a request context variable named <code class="literal">processInstance</code>. (Of course, these objects are available for injection via <code class="literal">@In</code>.)
								</p>
                </li>
                <li>
                  <p>
									<code class="literal">taskIdParameter</code> — the name of a request parameter which holds the id of the task. Default to <code class="literal">"taskId"</code>, which is also the default used by the Seam <code class="literal">taskList</code> JSF component.
								</p>
                </li>
                <li>
                  <p>
									<code class="literal">flushMode</code> — set the flush mode of any Seam-managed Hibernate sessions or JPA persistence contexts that are created during this conversation.
								</p>
                </li>
              </ul>
            </div>
          </dd>
          <dt>
            <a id="begintask-annotation"></a>
            <span class="term">
              <code class="literal">@BeginTask</code>
            </span>
          </dt>
          <dd>
            <p>
</p>
            <pre class="programlisting">@BeginTask
</pre>
            <p>
							 Resumes work on an incomplete jBPM task. Specifies that a long-running conversation begins when this method returns a non-null outcome without exception. This conversation is associated with the jBPM task specified in the named request parameter. Within the context of this conversation, a business process context is also defined, for the business process instance of the task instance.
						</p>
            <div class="itemizedlist">
              <ul>
                <li>
                  <p>
									The jBPM <code class="literal">org.jbpm.taskmgmt.exe.TaskInstance</code> will be available in a request context variable named <code class="literal">taskInstance</code>. The jPBM <code class="literal">org.jbpm.graph.exe.ProcessInstance</code> will be available in a request context variable named <code class="literal">processInstance</code>.
								</p>
                </li>
                <li>
                  <p>
									<code class="literal">taskIdParameter</code> — the name of a request parameter which holds the id of the task. Default to <code class="literal">"taskId"</code>, which is also the default used by the Seam <code class="literal">taskList</code> JSF component.
								</p>
                </li>
                <li>
                  <p>
									<code class="literal">flushMode</code> — set the flush mode of any Seam-managed Hibernate sessions or JPA persistence contexts that are created during this conversation.
								</p>
                </li>
              </ul>
            </div>
          </dd>
          <dt>
            <a id="endtask-annotation"></a>
            <span class="term">
              <code class="literal">@EndTask</code>
            </span>
          </dt>
          <dd>
            <p>
</p>
            <pre class="programlisting">@EndTask
</pre>
            <p>
							 "Ends" a jBPM task. Specifies that a long-running conversation ends when this method returns a non-null outcome, and that the current task is complete. Triggers a jBPM transition. The actual transition triggered will be the default transition unless the application has called <code class="literal">Transition.setName()</code> on the built-in component named <code class="literal">transition</code>.
						</p>
            <div class="itemizedlist">
              <ul>
                <li>
                  <p>
</p>
                  <pre class="programlisting">@EndTask(transition="transitionName")
</pre>
                  <p>
									 Triggers the given jBPM transition.
								</p>
                </li>
                <li>
                  <p>
									<code class="literal">transition</code> — the name of the jBPM transition to be triggered when ending the task. Defaults to the default transition.
								</p>
                </li>
                <li>
                  <p>
									<code class="literal">beforeRedirect</code> — by default, the conversation will not actually be destroyed until after any redirect has occurred. Setting <code class="literal">beforeRedirect=true</code> specifies that the conversation should be destroyed at the end of the current request, and that the redirect will be processed in a new temporary conversation context.
								</p>
                </li>
              </ul>
            </div>
          </dd>
          <dt>
            <a id="createprocess-annotation"></a>
            <span class="term">
              <code class="literal">@CreateProcess</code>
            </span>
          </dt>
          <dd>
            <p>
</p>
            <pre class="programlisting">@CreateProcess(definition="process definition name")
</pre>
            <p>
							 Creates a new jBPM process instance when the method returns a non-null outcome without exception. The <code class="literal">ProcessInstance</code> object will be available in a context variable named <code class="literal">processInstance</code>.
						</p>
            <div class="itemizedlist">
              <ul>
                <li>
                  <p>
									<code class="literal">definition</code> — the name of the jBPM process definition deployed via <code class="literal">org.jboss.seam.bpm.jbpm.processDefinitions</code>.
								</p>
                </li>
              </ul>
            </div>
          </dd>
          <dt>
            <a id="resumeprocess-annotation"></a>
            <span class="term">
              <code class="literal">@ResumeProcess</code>
            </span>
          </dt>
          <dd>
            <p>
</p>
            <pre class="programlisting">@ResumeProcess(processIdParameter="processId")
</pre>
            <p>
							 Re-enters the scope of an existing jBPM process instance when the method returns a non-null outcome without exception. The <code class="literal">ProcessInstance</code> object will be available in a context variable named <code class="literal">processInstance</code>.
						</p>
            <div class="itemizedlist">
              <ul>
                <li>
                  <p>
									<code class="literal">processIdParameter</code> — the name a request parameter holding the process id. Default to <code class="literal">"processId"</code>.
								</p>
                </li>
              </ul>
            </div>
          </dd>
          <dt>
            <a id="transition-annotation"></a>
            <span class="term">
              <code class="literal">@Transition</code>
            </span>
          </dt>
          <dd>
            <p>
</p>
            <pre class="programlisting">@Transition("cancel")
</pre>
            <p>
							 Marks a method as signalling a transition in the current jBPM process instance whenever the method returns a non-null result.
						</p>
          </dd>
        </dl>
      </div>
      <p>
		</p>
    </div>
    <ul xmlns="http://www.w3.org/1999/xhtml" class="docnav">
      <li class="previous">
        <a accesskey="p" href="ch26s03.html"><strong>Prev</strong>26.3. Annotations for component lifecycle methods</a>
      </li>
      <li class="up">
        <a accesskey="u" href="#">
          <strong>Up</strong>
        </a>
      </li>
      <li class="home">
        <a accesskey="h" href="index.html">
          <strong>Home</strong>
        </a>
      </li>
      <li class="next">
        <a accesskey="n" href="ch26s05.html"><strong>Next</strong>26.5. Annotations for use with Seam JavaBean comp...</a>
      </li>
    </ul>
  </body>
</html>
