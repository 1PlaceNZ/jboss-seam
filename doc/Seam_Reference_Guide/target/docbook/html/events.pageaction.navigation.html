<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <title>5.6. Navigation</title>
      <link rel="stylesheet" href="css/jbossorg.css" type="text/css"/>
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/>
      <link rel="start" href="index.html" title="Seam - Contextual Components"/>
      <link rel="up" href="events.html" title="Chapter 5. Events, interceptors and exception handling"/>
      <link rel="prev" href="ch05s05.html" title="5.5. Conversion and Validation"/>
      <link rel="next" href="ch05s07.html" title="5.7. Fine-grained files for definition of navigation, page actions and parameters"/>
   </head>
   <body>
      <p id="title">
         <a href="http://www.jboss.org" class="jbossOrg_href">
            <strong>
						        JBoss.org	
						</strong>
         </a>
         <a href="http://labs.jboss.com/projects/docs" class="commDoc_href">
            <strong>
						        Community Documentation	
						</strong>
         </a>
      </p>
      <ul class="docnav">
         <li class="previous">
            <a accesskey="p" href="ch05s05.html">
               <strong>Prev</strong>
            </a>
         </li>
         <li class="next">
            <a accesskey="n" href="ch05s07.html">
               <strong>Next</strong>
            </a>
         </li>
      </ul>
      <div class="section" lang="en">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title">
                     <a id="events.pageaction.navigation"/>5.6. Navigation</h2>
               </div>
            </div>
         </div>
         <p>
                You can use standard JSF navigation rules defined in <code class="literal">faces-config.xml</code>
                in a Seam application. However, JSF navigation rules have a number of annoying
                limitations:
            </p>
         <div class="itemizedlist">
            <ul>
               <li>
                  <p>
                        It is not possible to specify request parameters to be used when redirecting.
                    </p>
               </li>
               <li>
                  <p>
                        It is not possible to begin or end conversations from a rule.
                    </p>
               </li>
               <li>
                  <p>
                        Rules work by evaluating the return value of the action method; it is not
                        possible to evaluate an arbitrary EL expression.
                    </p>
               </li>
            </ul>
         </div>
         <p>
                A further problem is that "orchestration" logic gets scattered between <code class="literal">pages.xml</code>
                and <code class="literal">faces-config.xml</code>. It's better to unify this logic into <code class="literal">pages.xml</code>.
            </p>
         <p>
                This JSF navigation rule:
            </p>
         <pre class="programlisting">&lt;navigation-rule&gt;
    &lt;from-view-id&gt;/editDocument.xhtml&lt;/from-view-id&gt;
    
    &lt;navigation-case&gt;
        &lt;from-action&gt;#{documentEditor.update}&lt;/from-action&gt;
        &lt;from-outcome&gt;success&lt;/from-outcome&gt;
        &lt;to-view-id&gt;/viewDocument.xhtml&lt;/to-view-id&gt;
        &lt;redirect/&gt;
    &lt;/navigation-case&gt;
    
&lt;/navigation-rule&gt;</pre>
         <p>
                Can be rewritten as follows:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;
    
    &lt;navigation from-action="#{documentEditor.update}"&gt;
        &lt;rule if-outcome="success"&gt;
            &lt;redirect view-id="/viewDocument.xhtml"/&gt;
        &lt;/rule&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
         <p>
                But it would be even nicer if we didn't have to pollute our <code class="literal">DocumentEditor</code> 
                component with string-valued return values (the JSF outcomes). So Seam lets us write:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;
    
    &lt;navigation from-action="#{documentEditor.update}" 
                   evaluate="#{documentEditor.errors.size}"&gt;
        &lt;rule if-outcome="0"&gt;
            &lt;redirect view-id="/viewDocument.xhtml"/&gt;
        &lt;/rule&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
         <p>
                Or even:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;
    
    &lt;navigation from-action="#{documentEditor.update}"&gt;
        &lt;rule if="#{documentEditor.errors.empty}"&gt;
            &lt;redirect view-id="/viewDocument.xhtml"/&gt;
        &lt;/rule&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
         <p>
                The first form evaluates a value binding to determine the outcome value
                to be used by the subsequent rules.
                The second approach ignores the outcome and evaluates a value binding
                for each possible rule.
            </p>
         <p>
                Of course, when an update succeeds, we probably want to end the current
                conversation. We can do that like this:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;
    
    &lt;navigation from-action="#{documentEditor.update}"&gt;
        &lt;rule if="#{documentEditor.errors.empty}"&gt;
            &lt;end-conversation/&gt;
            &lt;redirect view-id="/viewDocument.xhtml"/&gt;
        &lt;/rule&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
         <p>
                As we've ended conversation any subsequent requests won't know
                which document we are interested in.  We can pass the document 
                id as a request parameter which also makes the view bookmarkable:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;
    
    &lt;navigation from-action="#{documentEditor.update}"&gt;
        &lt;rule if="#{documentEditor.errors.empty}"&gt;
            &lt;end-conversation/&gt;
            &lt;redirect view-id="/viewDocument.xhtml"&gt;
                &lt;param name="documentId" value="#{documentEditor.documentId}"/&gt;
            &lt;/redirect&gt;
        &lt;/rule&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
         <p>
                Null outcomes are a special case in JSF. The null outcome is interpreted to
                mean "redisplay the page". The following navigation rule matches any non-null
                outcome, but <span class="emphasis">
               <em>not</em>
            </span> the null outcome:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;
    
    &lt;navigation from-action="#{documentEditor.update}"&gt;
        &lt;rule&gt;
            &lt;render view-id="/viewDocument.xhtml"/&gt;
        &lt;/rule&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
         <p>
                If you want to perform navigation when a null outcome occurs, use the
                following form instead:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;
    
    &lt;navigation from-action="#{documentEditor.update}"&gt;
        &lt;render view-id="/viewDocument.xhtml"/&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
         <p>
                The view-id may be given as a JSF EL expression:
            </p>
         <pre class="programlisting">&lt;page view-id="/editDocument.xhtml"&gt;

    &lt;navigation&gt;
        &lt;rule if-outcome="success"&gt;
            &lt;redirect view-id="/#{userAgent}/displayDocument.xhtml"/&gt;
        &lt;/rule&gt;
    &lt;/navigation&gt;
    
&lt;/page&gt;</pre>
      </div>
      <ul class="docnav">
         <li class="previous">
            <a accesskey="p" href="ch05s05.html">
               <strong>Prev</strong>5.5. Conversion and Validation</a>
         </li>
         <li class="up">
            <a accesskey="u" href="#">
               <strong>Top of page</strong>
            </a>
         </li>
         <li class="home">
            <a accesskey="h" href="index.html">
               <strong>Front page</strong>
            </a>
         </li>
         <li class="next">
            <a accesskey="n" href="ch05s07.html">
               <strong>Next</strong>5.7. Fine-grained files for definition of navigat...</a>
         </li>
      </ul>
   </body>
</html>