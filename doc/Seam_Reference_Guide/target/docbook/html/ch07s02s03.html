<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <title>7.2.3. Page nodes and transitions</title>
      <link rel="stylesheet" href="css/jbossorg.css" type="text/css"/>
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/>
      <link rel="start" href="index.html" title="Seam - Contextual Components"/>
      <link rel="up" href="ch07s02.html" title="7.2. Using jPDL pageflows"/>
      <link rel="prev" href="ch07s02s02.html" title="7.2.2. Starting pageflows"/>
      <link rel="next" href="ch07s02s04.html" title="7.2.4. Controlling the flow"/>
   </head>
   <body>
      <p id="title">
         <a href="http://www.jboss.org" class="jbossOrg_href">
            <strong>
						        JBoss.org	
						</strong>
         </a>
         <a href="http://labs.jboss.com/projects/docs" class="commDoc_href">
            <strong>
						        Community Documentation	
						</strong>
         </a>
      </p>
      <ul class="docnav">
         <li class="previous">
            <a accesskey="p" href="ch07s02s02.html">
               <strong>Prev</strong>
            </a>
         </li>
         <li class="next">
            <a accesskey="n" href="ch07s02s04.html">
               <strong>Next</strong>
            </a>
         </li>
      </ul>
      <div class="section" lang="en">
         <div class="titlepage">
            <div>
               <div>
                  <h3 class="title">
                     <a id="d0e5631"/>7.2.3. Page nodes and transitions</h3>
               </div>
            </div>
         </div>
         <p>
            Each <code class="literal">&lt;page&gt;</code> node represents a state where
            the system is waiting for user input:
        </p>
         <pre class="programlisting">&lt;page name="displayGuess" view-id="/numberGuess.jsp"&gt;
    &lt;redirect/&gt;
    &lt;transition name="guess" to="evaluateGuess"&gt;
        &lt;action expression="#{numberGuess.guess}" /&gt;
    &lt;/transition&gt;
&lt;/page&gt;</pre>
         <p>
            The <code class="literal">view-id</code> is the JSF view id. The <code class="literal">&lt;redirect/&gt;</code>
            element has the same effect as <code class="literal">&lt;redirect/&gt;</code> in a 
            JSF navigation rule: namely, a post-then-redirect behavior, to overcome problems
            with the browser's refresh button. (Note that Seam propagates conversation contexts
            over these browser redirects. So there is no need for a Ruby on Rails style "flash"
            construct in Seam!)
        </p>
         <p>
            The transition name is the name of a JSF outcome triggered by clicking
            a command button or command link in <code class="literal">numberGuess.jsp</code>. 
        </p>
         <pre class="programlisting">&lt;h:commandButton type="submit" value="Guess" action="guess"/&gt;</pre>
         <p>
            When the transition is triggered by clicking this button, jBPM will activate the
            transition action by calling the <code class="literal">guess()</code> method of the
            <code class="literal">numberGuess</code> component. Notice that the syntax used for
            specifying actions in the jPDL is just a familiar JSF EL expression, and that 
            the transition action handler is just a method of a Seam component in the
            current Seam contexts. So we have exactly the same event model for jBPM events 
            that we already have for JSF events! (The <span class="emphasis">
               <em>One Kind of Stuff</em>
            </span> 
            principle.)
        </p>
         <p>
            In the case of a null outcome (for example, a command button with no 
            <code class="literal">action</code> defined), Seam will signal the transition with no
            name if one exists, or else simply redisplay the page if all transitions
            have names. So we could slightly simplify our example pageflow and this button:
        </p>
         <pre class="programlisting">&lt;h:commandButton type="submit" value="Guess"/&gt;</pre>
         <p>
            Would fire the following un-named transition:
        </p>
         <pre class="programlisting">&lt;page name="displayGuess" view-id="/numberGuess.jsp"&gt;
    &lt;redirect/&gt;
    &lt;transition to="evaluateGuess"&gt;
        &lt;action expression="#{numberGuess.guess}" /&gt;
    &lt;/transition&gt;
&lt;/page&gt;</pre>
         <p>
            It is even possible to have the button call an action method, in which case the
            action outcome will determine the transition to be taken:
        </p>
         <pre class="programlisting">&lt;h:commandButton type="submit" value="Guess" action="#{numberGuess.guess}"/&gt;</pre>
         <pre class="programlisting">&lt;page name="displayGuess" view-id="/numberGuess.jsp"&gt;
    &lt;transition name="correctGuess" to="win"/&gt;
    &lt;transition name="incorrectGuess" to="evaluateGuess"/&gt;
&lt;/page&gt;</pre>
         <p>
            However, this is considered an inferior style, since it moves responsibility for
            controlling the flow out of the pageflow definition and back into the other
            components. It is much better to centralize this concern in the pageflow itself.
        </p>
      </div>
      <ul class="docnav">
         <li class="previous">
            <a accesskey="p" href="ch07s02s02.html">
               <strong>Prev</strong>7.2.2. Starting pageflows</a>
         </li>
         <li class="up">
            <a accesskey="u" href="#">
               <strong>Top of page</strong>
            </a>
         </li>
         <li class="home">
            <a accesskey="h" href="index.html">
               <strong>Front page</strong>
            </a>
         </li>
         <li class="next">
            <a accesskey="n" href="ch07s02s04.html">
               <strong>Next</strong>7.2.4. Controlling the flow</a>
         </li>
      </ul>
   </body>
</html>