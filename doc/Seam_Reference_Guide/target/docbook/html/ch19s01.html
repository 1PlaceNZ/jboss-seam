<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <title>19.1. Using JBossCache in Seam</title>
      <link rel="stylesheet" href="css/jbossorg.css" type="text/css"/>
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/>
      <link rel="start" href="index.html" title="Seam - Contextual Components"/>
      <link rel="up" href="cache.html" title="Chapter 19. Caching"/>
      <link rel="prev" href="cache.html" title="Chapter 19. Caching"/>
      <link rel="next" href="ch19s02.html" title="19.2. Page fragment caching"/>
   </head>
   <body>
      <p id="title">
         <a href="http://www.jboss.org" class="jbossOrg_href">
            <strong>
						        JBoss.org	
						</strong>
         </a>
         <a href="http://labs.jboss.com/projects/docs" class="commDoc_href">
            <strong>
						        Community Documentation	
						</strong>
         </a>
      </p>
      <ul class="docnav">
         <li class="previous">
            <a accesskey="p" href="cache.html">
               <strong>Prev</strong>
            </a>
         </li>
         <li class="next">
            <a accesskey="n" href="ch19s02.html">
               <strong>Next</strong>
            </a>
         </li>
      </ul>
      <div class="section" lang="en">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title">
                     <a id="d0e13657"/>19.1. Using JBossCache in Seam</h2>
               </div>
            </div>
         </div>
         <p>
            The built-in <code class="literal">pojoCache</code> component manages an instance
            of <code class="literal">org.jboss.cache.aop.PojoCache</code>. You can safely put 
            any immutable Java object in the cache, and it will be replicated across
            the cluster (assuming that replication is enabled). If you want to
            keep mutable objects in the cache, you'll need to run the JBossCache
            bytecode preprocessor to ensure that changes to the objects will be
            automatically detected and replicated.
        </p>
         <p>
            To use <code class="literal">pojoCache</code>, all you need to do is put the
            JBossCache jars in the classpath, and provide a resource named
            <code class="literal">treecache.xml</code> with an appropriate cache configuration.
            JBossCache has many scary and confusing configuration settings, so
            we won't discuss them here. Please refer to the JBossCache documentation
            for more information.
        </p>
         <p>
            You can find a sample <code class="literal">treecache.xml</code> in
            <code class="literal">examples/blog/resources/treecache.xml</code>.
        </p>
         <p>
            For an EAR depoyment of Seam, we recommend that the JBossCache jars and
            configuration go directly into the EAR. Make sure you place both
            <code class="literal">jboss-cache.jar</code> and <code class="literal">jgroups.jar</code>
            in your EAR's lib folder.
        </p>
         <p>
            Now you can inject the cache into any Seam component:
        </p>
         <pre class="programlisting">@Name("chatroom")
public class Chatroom {
    @In PojoCache pojoCache;
    
    public void join(String username) {
      try
      {
         Set&lt;String&gt; userList = (Set&lt;String&gt;) pojoCache.get("chatroom", "userList");
         if (userList==null) 
         {
            userList = new HashSet&lt;String&gt;();
            pojoCache.put("chatroom", "userList", userList);
         }
         userList.put(username);
      }
      catch (CacheException ce)
      {
         throw new RuntimeException(ce);
      }
    }
}</pre>
         <p>
            If you want to have multiple JBossCache configurations in your application,
            use <code class="literal">components.xml</code>:
        </p>
         <pre class="programlisting">&lt;core:pojo-cache name="myCache" cfg-resource-name="myown/cache.xml"/&gt;</pre>
      </div>
      <ul class="docnav">
         <li class="previous">
            <a accesskey="p" href="cache.html">
               <strong>Prev</strong>Chapter 19. Caching</a>
         </li>
         <li class="up">
            <a accesskey="u" href="#">
               <strong>Top of page</strong>
            </a>
         </li>
         <li class="home">
            <a accesskey="h" href="index.html">
               <strong>Front page</strong>
            </a>
         </li>
         <li class="next">
            <a accesskey="n" href="ch19s02.html">
               <strong>Next</strong>19.2. Page fragment caching</a>
         </li>
      </ul>
   </body>
</html>